<!doctype html>
<html lang="ko">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>중3 이차함수 그래프 그리기</title>
    <link rel="stylesheet" href="./src/styles.css" />
    <script>
      window.MathJax = {
        tex: {
          inlineMath: [['\\(', '\\)']],
          displayMath: [['\\[', '\\]']],
          processEscapes: true
        },
        startup: {
          ready: () => {
            MathJax.startup.defaultReady();
            MathJax.startup.promise.then(() => {
              console.log('MathJax is ready');
              // MathJax가 준비되면 모든 수식 렌더링
              if (window.MathJax && window.MathJax.typesetPromise) {
                const problemTextEl = document.getElementById('problem-text');
                if (problemTextEl) {
                  window.MathJax.typesetPromise([problemTextEl]).catch((err) => {
                    console.error('MathJax 초기 렌더링 오류:', err);
                  });
                }
              }
            });
          }
        }
      };
    </script>
    <script id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
  </head>
  <body class="page page-student">
    <header class="site-header">
      <h1>이차함수 그래프 그리기</h1>
      <p class="subtitle">단계별 질문에 답하다 보면 이차함수 그래프를 완성할 수 있어요!</p>
    </header>

    <main class="content content-two-columns">
      <section class="card problem-panel">
        <header class="panel-header">
          <h2>문제</h2>
          <div id="student-info" class="student-info"></div>
        </header>

        <div id="problem-visual" class="problem-visual">
          <!-- 선택된 문제에 따라 JS에서 이미지/도식이 표시됨 -->
        </div>

        <div id="problem-text" class="problem-text">
          <!-- 문제 설명 텍스트 -->
        </div>

        <div class="shape-question-section">
          <p class="question-text">1단계. 그래프의 모양은 위로 볼록인가요,<br>아래로 볼록인가요?</p>
          <div class="shape-buttons">
            <button id="shape-convex-up" class="btn shape-btn" type="button">
              <div class="shape-btn-content">
                <div class="shape-label">위로 볼록</div>
                <svg class="shape-icon" viewBox="0 0 140 100" xmlns="http://www.w3.org/2000/svg">
                  <defs>
                    <linearGradient id="gradient-up" x1="0%" y1="0%" x2="0%" y2="100%">
                      <stop offset="0%" style="stop-color:#2563eb;stop-opacity:1" />
                      <stop offset="100%" style="stop-color:#1d4ed8;stop-opacity:1" />
                    </linearGradient>
                  </defs>
                  <path d="M 15 85 Q 70 5, 125 85" stroke="url(#gradient-up)" stroke-width="6" fill="none" stroke-linecap="round" stroke-linejoin="round"/>
                </svg>
              </div>
            </button>
            <button id="shape-convex-down" class="btn shape-btn" type="button">
              <div class="shape-btn-content">
                <div class="shape-label">아래로 볼록</div>
                <svg class="shape-icon" viewBox="0 0 140 100" xmlns="http://www.w3.org/2000/svg">
                  <defs>
                    <linearGradient id="gradient-down" x1="0%" y1="0%" x2="0%" y2="100%">
                      <stop offset="0%" style="stop-color:#2563eb;stop-opacity:1" />
                      <stop offset="100%" style="stop-color:#1d4ed8;stop-opacity:1" />
                    </linearGradient>
                  </defs>
                  <path d="M 15 15 Q 70 95, 125 15" stroke="url(#gradient-down)" stroke-width="6" fill="none" stroke-linecap="round" stroke-linejoin="round"/>
                </svg>
              </div>
            </button>
          </div>
        </div>
      </section>

      <section class="card drawing-panel">
        <h2 class="panel-title">그리기 도구를 선택한 후 좌표평면에 그래프를 그릴 수 있습니다.</h2>
        <p class="hint">
          1. 먼저 그래프의 '꼭짓점'을 좌표평면에 찍습니다.<br>
          2. '꼭짓점 외에 지나는 점'을 좌표평면에 직습니다.<br>
          3. '그래프 그리기'를 누르면 두 점을 지나는 그래프가 그려집니다.<br>
          4. '확인'을 눌러 그래프가 올바르게 그려졌는지 확인하세요. 만약 잘못 그려졌다면 '지우기'를 눌러 좌표평면을 초기화할 수 있습니다.
        </p>

        <div class="clue-board">
          <h3>그래프에 대한 단서</h3>
          <p class="clue-desc">단계별로 맞힌 정보가 여기에 모여요.</p>
          <div id="clue-list" class="clue-list"></div>
        </div>

        <div class="drawing-tools-wrapper">
          <div class="drawing-tools">
            <h3>그리기 도구</h3>
            <div class="tool-buttons">
              <button id="tool-vertex" class="tool-btn active" data-mode="vertex">꼭짓점</button>
              <button id="tool-point" class="tool-btn" data-mode="point">꼭짓점 외에 지나는 점</button>
            </div>
          </div>
          <div class="canvas-wrapper">
            <canvas id="fbd-canvas" width="480" height="360"></canvas>
          </div>
        </div>

        <div class="drawing-actions">
          <button id="clear-canvas" class="btn" type="button">지우기</button>
          <button id="draw-graph" class="btn primary" type="button">그래프 그리기</button>
          <button id="check-graph" class="btn" type="button">확인</button>
        </div>

        <form id="answer-form" class="form-vertical hidden">
          <label>
            그래프에 대한 설명
            <textarea
              id="answer-description"
              rows="3"
              placeholder="그그린 그래프에 대해 다음의의 요소들을 포함하여 설명해 보세요.&#10;[꼭짓점의 위치, y절편, 그래프의 개형형]"
            ></textarea>
          </label>

          <div class="form-actions">
            <button type="submit" class="btn primary">그래프에 대한 설명 제출하고 AI 피드백 받기</button>
          </div>
        </form>

        <section id="feedback-section" class="feedback-section hidden">
          <h3>AI 피드백</h3>
          <div id="feedback-content" class="feedback-content"></div>
        </section>
      </section>
    </main>

    <footer class="site-footer">
      <a href="./index.html" class="btn link">메인으로 돌아가기</a>
    </footer>

    <!-- 커스텀 모달 -->
    <div id="shape-modal" class="shape-modal">
      <div class="shape-modal-overlay"></div>
      <div class="shape-modal-content">
        <div class="shape-modal-icon"></div>
        <h3 class="shape-modal-title"></h3>
        <p class="shape-modal-message"></p>
        <button class="btn primary shape-modal-close">확인</button>
      </div>
    </div>

    <script type="module" src="./src/main.js"></script>
  </body>
</html>





